[{"data":1,"prerenderedAt":696},["ShallowReactive",2],{"navigation":3,"/usage/services/serversupabasesession":58,"/usage/services/serversupabasesession-surround":691},[4,8,12,46,50,54],{"title":5,"_path":6,"icon":7},"Get Started","/get-started","i-heroicons-rocket-launch",{"title":9,"_path":10,"icon":11},"Authentication","/authentication","i-heroicons-lock-closed",{"title":13,"_path":14,"children":15,"icon":45},"Usage","/usage",[16,29],{"title":17,"_path":18,"children":19},"Vue composables","/usage/composables",[20,23,26],{"title":21,"_path":22},"useSupabaseClient","/usage/composables/usesupabaseclient",{"title":24,"_path":25},"useSupabaseSession","/usage/composables/usesupabasesession",{"title":27,"_path":28},"useSupabaseUser","/usage/composables/usesupabaseuser",{"title":30,"_path":31,"children":32},"Server services","/usage/services",[33,36,39,42],{"title":34,"_path":35},"serverSupabaseClient","/usage/services/serversupabaseclient",{"title":37,"_path":38},"serverSupabaseServiceRole","/usage/services/serversupabaseservicerole",{"title":40,"_path":41},"serverSupabaseSession","/usage/services/serversupabasesession",{"title":43,"_path":44},"serverSupabaseUser","/usage/services/serversupabaseuser","heroicons:book-open",{"title":47,"_path":48,"icon":49},"Demo","/demo","i-heroicons-computer-desktop-20-solid",{"title":51,"_path":52,"icon":53},"Changelog","/changelog","i-heroicons-bookmark",{"title":55,"_path":56,"icon":57},"Roadmap","/roadmap","i-heroicons-map",{"_path":41,"_dir":59,"_draft":60,"_partial":60,"_locale":61,"title":40,"description":62,"body":63,"_type":685,"_id":686,"_source":687,"_file":688,"_stem":689,"_extension":690},"services",false,"","Get your Supabase user's session from serverside with the serverSupabaseUser service",{"type":64,"children":65,"toc":683},"root",[66,91,111,131,150,322,327,473,487,677],{"type":67,"tag":68,"props":69,"children":72},"element","callout",{"color":70,"icon":71},"amber","i-heroicons-exclamation-triangle-20-solid",[73],{"type":67,"tag":74,"props":75,"children":76},"p",{},[77,80,89],{"type":78,"value":79},"text","This section assumes you're familiar with ",{"type":67,"tag":81,"props":82,"children":86},"a",{"href":83,"rel":84},"https://v3.nuxtjs.org/guide/concepts/server-engine",[85],"nofollow",[87],{"type":78,"value":88},"Nitro",{"type":78,"value":90},", the server engine powered by Nuxt.",{"type":67,"tag":74,"props":92,"children":93},{},[94,96,100,102,109],{"type":78,"value":95},"This function is similar to the ",{"type":67,"tag":81,"props":97,"children":98},{"href":25},[99],{"type":78,"value":24},{"type":78,"value":101}," composable but is used in ",{"type":67,"tag":81,"props":103,"children":106},{"href":104,"rel":105},"https://nuxt.com/docs/guide/directory-structure/server#server-routes",[85],[107],{"type":78,"value":108},"server routes",{"type":78,"value":110},".",{"type":67,"tag":68,"props":112,"children":113},{"color":70,"icon":71},[114],{"type":67,"tag":74,"props":115,"children":116},{},[117,119,125,127],{"type":78,"value":118},"Be advised that ",{"type":67,"tag":120,"props":121,"children":123},"code",{"className":122},[],[124],{"type":78,"value":40},{"type":78,"value":126}," is considered unsafe, since the session comes from the client and users can tamper with it. For checking if the user is logged in, always use  ",{"type":67,"tag":81,"props":128,"children":129},{"href":44},[130],{"type":78,"value":43},{"type":67,"tag":74,"props":132,"children":133},{},[134,136,141,143,149],{"type":78,"value":135},"Define your server route and import the ",{"type":67,"tag":120,"props":137,"children":139},{"className":138},[],[140],{"type":78,"value":40},{"type":78,"value":142}," from ",{"type":67,"tag":120,"props":144,"children":146},{"className":145},[],[147],{"type":78,"value":148},"#supabase/server",{"type":78,"value":110},{"type":67,"tag":151,"props":152,"children":157},"pre",{"className":153,"code":154,"filename":155,"language":156,"meta":61,"style":61},"language-ts shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","import { serverSupabaseSession } from '#supabase/server'\n\nexport default defineEventHandler(async (event) => {\n  return await serverSupabaseSession(event)\n})\n","server/api/session.ts","ts",[158],{"type":67,"tag":120,"props":159,"children":160},{"__ignoreMap":61},[161,210,220,277,309],{"type":67,"tag":162,"props":163,"children":166},"span",{"class":164,"line":165},"line",1,[167,173,179,185,190,195,200,205],{"type":67,"tag":162,"props":168,"children":170},{"style":169},"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic",[171],{"type":78,"value":172},"import",{"type":67,"tag":162,"props":174,"children":176},{"style":175},"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF",[177],{"type":78,"value":178}," {",{"type":67,"tag":162,"props":180,"children":182},{"style":181},"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8",[183],{"type":78,"value":184}," serverSupabaseSession",{"type":67,"tag":162,"props":186,"children":187},{"style":175},[188],{"type":78,"value":189}," }",{"type":67,"tag":162,"props":191,"children":192},{"style":169},[193],{"type":78,"value":194}," from",{"type":67,"tag":162,"props":196,"children":197},{"style":175},[198],{"type":78,"value":199}," '",{"type":67,"tag":162,"props":201,"children":203},{"style":202},"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D",[204],{"type":78,"value":148},{"type":67,"tag":162,"props":206,"children":207},{"style":175},[208],{"type":78,"value":209},"'\n",{"type":67,"tag":162,"props":211,"children":213},{"class":164,"line":212},2,[214],{"type":67,"tag":162,"props":215,"children":217},{"emptyLinePlaceholder":216},true,[218],{"type":78,"value":219},"\n",{"type":67,"tag":162,"props":221,"children":223},{"class":164,"line":222},3,[224,229,234,240,245,251,256,262,267,272],{"type":67,"tag":162,"props":225,"children":226},{"style":169},[227],{"type":78,"value":228},"export",{"type":67,"tag":162,"props":230,"children":231},{"style":169},[232],{"type":78,"value":233}," default",{"type":67,"tag":162,"props":235,"children":237},{"style":236},"--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF",[238],{"type":78,"value":239}," defineEventHandler",{"type":67,"tag":162,"props":241,"children":242},{"style":181},[243],{"type":78,"value":244},"(",{"type":67,"tag":162,"props":246,"children":248},{"style":247},"--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA",[249],{"type":78,"value":250},"async",{"type":67,"tag":162,"props":252,"children":253},{"style":175},[254],{"type":78,"value":255}," (",{"type":67,"tag":162,"props":257,"children":259},{"style":258},"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic",[260],{"type":78,"value":261},"event",{"type":67,"tag":162,"props":263,"children":264},{"style":175},[265],{"type":78,"value":266},")",{"type":67,"tag":162,"props":268,"children":269},{"style":247},[270],{"type":78,"value":271}," =>",{"type":67,"tag":162,"props":273,"children":274},{"style":175},[275],{"type":78,"value":276}," {\n",{"type":67,"tag":162,"props":278,"children":280},{"class":164,"line":279},4,[281,286,291,295,300,304],{"type":67,"tag":162,"props":282,"children":283},{"style":169},[284],{"type":78,"value":285},"  return",{"type":67,"tag":162,"props":287,"children":288},{"style":169},[289],{"type":78,"value":290}," await",{"type":67,"tag":162,"props":292,"children":293},{"style":236},[294],{"type":78,"value":184},{"type":67,"tag":162,"props":296,"children":298},{"style":297},"--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178",[299],{"type":78,"value":244},{"type":67,"tag":162,"props":301,"children":302},{"style":181},[303],{"type":78,"value":261},{"type":67,"tag":162,"props":305,"children":306},{"style":297},[307],{"type":78,"value":308},")\n",{"type":67,"tag":162,"props":310,"children":312},{"class":164,"line":311},5,[313,318],{"type":67,"tag":162,"props":314,"children":315},{"style":175},[316],{"type":78,"value":317},"}",{"type":67,"tag":162,"props":319,"children":320},{"style":181},[321],{"type":78,"value":308},{"type":67,"tag":74,"props":323,"children":324},{},[325],{"type":78,"value":326},"Then call your api route from any vue file:",{"type":67,"tag":151,"props":328,"children":331},{"className":153,"code":329,"filename":330,"language":156,"meta":61,"style":61},"const session = ref(null)\n\nconst fetchSession = async () => {\n   session.value = await $fetch('/api/session')\n}\n","pages/index.vue",[332],{"type":67,"tag":120,"props":333,"children":334},{"__ignoreMap":61},[335,371,378,412,465],{"type":67,"tag":162,"props":336,"children":337},{"class":164,"line":165},[338,343,348,353,358,362,367],{"type":67,"tag":162,"props":339,"children":340},{"style":247},[341],{"type":78,"value":342},"const",{"type":67,"tag":162,"props":344,"children":345},{"style":181},[346],{"type":78,"value":347}," session ",{"type":67,"tag":162,"props":349,"children":350},{"style":175},[351],{"type":78,"value":352},"=",{"type":67,"tag":162,"props":354,"children":355},{"style":236},[356],{"type":78,"value":357}," ref",{"type":67,"tag":162,"props":359,"children":360},{"style":181},[361],{"type":78,"value":244},{"type":67,"tag":162,"props":363,"children":364},{"style":175},[365],{"type":78,"value":366},"null",{"type":67,"tag":162,"props":368,"children":369},{"style":181},[370],{"type":78,"value":308},{"type":67,"tag":162,"props":372,"children":373},{"class":164,"line":212},[374],{"type":67,"tag":162,"props":375,"children":376},{"emptyLinePlaceholder":216},[377],{"type":78,"value":219},{"type":67,"tag":162,"props":379,"children":380},{"class":164,"line":222},[381,385,390,394,399,404,408],{"type":67,"tag":162,"props":382,"children":383},{"style":247},[384],{"type":78,"value":342},{"type":67,"tag":162,"props":386,"children":387},{"style":181},[388],{"type":78,"value":389}," fetchSession ",{"type":67,"tag":162,"props":391,"children":392},{"style":175},[393],{"type":78,"value":352},{"type":67,"tag":162,"props":395,"children":396},{"style":247},[397],{"type":78,"value":398}," async",{"type":67,"tag":162,"props":400,"children":401},{"style":175},[402],{"type":78,"value":403}," ()",{"type":67,"tag":162,"props":405,"children":406},{"style":247},[407],{"type":78,"value":271},{"type":67,"tag":162,"props":409,"children":410},{"style":175},[411],{"type":78,"value":276},{"type":67,"tag":162,"props":413,"children":414},{"class":164,"line":279},[415,420,424,429,434,438,443,447,452,457,461],{"type":67,"tag":162,"props":416,"children":417},{"style":181},[418],{"type":78,"value":419},"   session",{"type":67,"tag":162,"props":421,"children":422},{"style":175},[423],{"type":78,"value":110},{"type":67,"tag":162,"props":425,"children":426},{"style":181},[427],{"type":78,"value":428},"value",{"type":67,"tag":162,"props":430,"children":431},{"style":175},[432],{"type":78,"value":433}," =",{"type":67,"tag":162,"props":435,"children":436},{"style":169},[437],{"type":78,"value":290},{"type":67,"tag":162,"props":439,"children":440},{"style":236},[441],{"type":78,"value":442}," $fetch",{"type":67,"tag":162,"props":444,"children":445},{"style":297},[446],{"type":78,"value":244},{"type":67,"tag":162,"props":448,"children":449},{"style":175},[450],{"type":78,"value":451},"'",{"type":67,"tag":162,"props":453,"children":454},{"style":202},[455],{"type":78,"value":456},"/api/session",{"type":67,"tag":162,"props":458,"children":459},{"style":175},[460],{"type":78,"value":451},{"type":67,"tag":162,"props":462,"children":463},{"style":297},[464],{"type":78,"value":308},{"type":67,"tag":162,"props":466,"children":467},{"class":164,"line":311},[468],{"type":67,"tag":162,"props":469,"children":470},{"style":175},[471],{"type":78,"value":472},"}\n",{"type":67,"tag":74,"props":474,"children":475},{},[476,478,485],{"type":78,"value":477},"Be careful, if you want to call this route on SSR, please read this ",{"type":67,"tag":81,"props":479,"children":482},{"href":480,"rel":481},"https://nuxt.com/docs/getting-started/data-fetching#isomorphic-fetch-and-fetch",[85],[483],{"type":78,"value":484},"section",{"type":78,"value":486},", you must send your browser cookies including your supabase token.",{"type":67,"tag":151,"props":488,"children":490},{"className":153,"code":489,"filename":330,"language":156,"meta":61,"style":61},"const session = ref(null)\n\nconst { data } = await useFetch('/api/session', {\n  headers: useRequestHeaders(['cookie'])\n})\n\nsession.value = data\n",[491],{"type":67,"tag":120,"props":492,"children":493},{"__ignoreMap":61},[494,525,532,590,631,642,650],{"type":67,"tag":162,"props":495,"children":496},{"class":164,"line":165},[497,501,505,509,513,517,521],{"type":67,"tag":162,"props":498,"children":499},{"style":247},[500],{"type":78,"value":342},{"type":67,"tag":162,"props":502,"children":503},{"style":181},[504],{"type":78,"value":347},{"type":67,"tag":162,"props":506,"children":507},{"style":175},[508],{"type":78,"value":352},{"type":67,"tag":162,"props":510,"children":511},{"style":236},[512],{"type":78,"value":357},{"type":67,"tag":162,"props":514,"children":515},{"style":181},[516],{"type":78,"value":244},{"type":67,"tag":162,"props":518,"children":519},{"style":175},[520],{"type":78,"value":366},{"type":67,"tag":162,"props":522,"children":523},{"style":181},[524],{"type":78,"value":308},{"type":67,"tag":162,"props":526,"children":527},{"class":164,"line":212},[528],{"type":67,"tag":162,"props":529,"children":530},{"emptyLinePlaceholder":216},[531],{"type":78,"value":219},{"type":67,"tag":162,"props":533,"children":534},{"class":164,"line":222},[535,539,543,548,552,556,560,565,569,573,577,581,586],{"type":67,"tag":162,"props":536,"children":537},{"style":247},[538],{"type":78,"value":342},{"type":67,"tag":162,"props":540,"children":541},{"style":175},[542],{"type":78,"value":178},{"type":67,"tag":162,"props":544,"children":545},{"style":181},[546],{"type":78,"value":547}," data ",{"type":67,"tag":162,"props":549,"children":550},{"style":175},[551],{"type":78,"value":317},{"type":67,"tag":162,"props":553,"children":554},{"style":175},[555],{"type":78,"value":433},{"type":67,"tag":162,"props":557,"children":558},{"style":169},[559],{"type":78,"value":290},{"type":67,"tag":162,"props":561,"children":562},{"style":236},[563],{"type":78,"value":564}," useFetch",{"type":67,"tag":162,"props":566,"children":567},{"style":181},[568],{"type":78,"value":244},{"type":67,"tag":162,"props":570,"children":571},{"style":175},[572],{"type":78,"value":451},{"type":67,"tag":162,"props":574,"children":575},{"style":202},[576],{"type":78,"value":456},{"type":67,"tag":162,"props":578,"children":579},{"style":175},[580],{"type":78,"value":451},{"type":67,"tag":162,"props":582,"children":583},{"style":175},[584],{"type":78,"value":585},",",{"type":67,"tag":162,"props":587,"children":588},{"style":175},[589],{"type":78,"value":276},{"type":67,"tag":162,"props":591,"children":592},{"class":164,"line":279},[593,598,603,608,613,617,622,626],{"type":67,"tag":162,"props":594,"children":595},{"style":297},[596],{"type":78,"value":597},"  headers",{"type":67,"tag":162,"props":599,"children":600},{"style":175},[601],{"type":78,"value":602},":",{"type":67,"tag":162,"props":604,"children":605},{"style":236},[606],{"type":78,"value":607}," useRequestHeaders",{"type":67,"tag":162,"props":609,"children":610},{"style":181},[611],{"type":78,"value":612},"([",{"type":67,"tag":162,"props":614,"children":615},{"style":175},[616],{"type":78,"value":451},{"type":67,"tag":162,"props":618,"children":619},{"style":202},[620],{"type":78,"value":621},"cookie",{"type":67,"tag":162,"props":623,"children":624},{"style":175},[625],{"type":78,"value":451},{"type":67,"tag":162,"props":627,"children":628},{"style":181},[629],{"type":78,"value":630},"])\n",{"type":67,"tag":162,"props":632,"children":633},{"class":164,"line":311},[634,638],{"type":67,"tag":162,"props":635,"children":636},{"style":175},[637],{"type":78,"value":317},{"type":67,"tag":162,"props":639,"children":640},{"style":181},[641],{"type":78,"value":308},{"type":67,"tag":162,"props":643,"children":645},{"class":164,"line":644},6,[646],{"type":67,"tag":162,"props":647,"children":648},{"emptyLinePlaceholder":216},[649],{"type":78,"value":219},{"type":67,"tag":162,"props":651,"children":653},{"class":164,"line":652},7,[654,659,663,668,672],{"type":67,"tag":162,"props":655,"children":656},{"style":181},[657],{"type":78,"value":658},"session",{"type":67,"tag":162,"props":660,"children":661},{"style":175},[662],{"type":78,"value":110},{"type":67,"tag":162,"props":664,"children":665},{"style":181},[666],{"type":78,"value":667},"value ",{"type":67,"tag":162,"props":669,"children":670},{"style":175},[671],{"type":78,"value":352},{"type":67,"tag":162,"props":673,"children":674},{"style":181},[675],{"type":78,"value":676}," data\n",{"type":67,"tag":678,"props":679,"children":680},"style",{},[681],{"type":78,"value":682},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":61,"searchDepth":212,"depth":212,"links":684},[],"markdown","content:4.usage:services:3.serverSupabaseSession.md","content","4.usage/services/3.serverSupabaseSession.md","4.usage/services/3.serverSupabaseSession","md",[692,694],{"_path":38,"title":37,"description":693},"Make requests with super admin rights to the Supabase API with the serverSupabaseServiceRole service",{"_path":44,"title":43,"description":695},"Get your Supabase user from serverside with the serverSupabaseUser service",1737370325048]